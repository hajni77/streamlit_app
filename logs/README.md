# Performance Logging System for Bathroom Layout Generator

This directory contains log files generated by the timing_logger utility, which tracks the performance of various operations in the bathroom layout generator.

## Files

- `layout_timing.log`: Text log file with detailed timing information
- `layout_timing.csv`: CSV file with structured timing data for analysis

## Logged Operations

The system tracks the following operations:

1. **layout_generation**: Overall time to generate a complete layout
2. **layout_scoring**: Time to score a single layout
3. **object_placement**: Time to place individual objects

## Visualizations

Two visualization options are available for the timing data:

1. **Streamlit UI**: Navigate to the "Performance" tab in the Streamlit app
2. **Standalone visualizations**: Run the `visualize_timing.py` script to generate charts

## Log Format

Each log entry includes:

- Timestamp
- Operation type
- Duration in milliseconds
- Layout identifier
- Room dimensions
- Number of objects
- Additional information (e.g., layout score, beam width)

## Viewing Performance Metrics

### In Streamlit App

You can view performance metrics in the Streamlit app by navigating to the "Performance" tab. This provides visualizations and analytics on:

- Average time for each operation
- Relationship between room size and performance
- Relationship between number of objects and performance
- Performance recommendations

### Standalone Visualizations

For more advanced visualization, use the `visualize_timing.py` script:

```bash
# Generate all visualizations and save to the timing_visualizations directory
python visualize_timing.py

# Show visualizations without saving
python visualize_timing.py --show

# Specify custom output directory
python visualize_timing.py --output-dir my_visualizations

# Set the number of days to include in timeline chart
python visualize_timing.py --days 14
```

This generates several detailed charts:

1. **Operation Comparison**: Boxplots, violin plots, and bar charts comparing operation durations
2. **Scaling Analysis**: Charts showing how performance scales with room size and object count
3. **Operations Timeline**: Timeline of all operations with duration trends

## Programmatic Access

### Timing Analysis

To analyze log data programmatically, use the functions in `utils/timing_analysis.py`:

```python
from utils.timing_analysis import load_timing_data, get_summary_stats

# Load timing data
data = load_timing_data()

# Get summary statistics
stats = get_summary_stats(data)

# Print average time for layout generation
for op in stats['operations']:
    if op['operation'] == 'layout_generation':
        print(f"Average layout generation time: {op['avg_ms']} ms")
```

### Timing Visualization

For custom visualizations, use the functions in `utils/timing_visualizer.py`:

```python
import matplotlib.pyplot as plt
from utils.timing_visualizer import (
    load_timing_data, 
    create_operation_comparison_chart, 
    create_scaling_analysis_chart
)

# Load data
data = load_timing_data()

# Create a comparison chart
fig = create_operation_comparison_chart(data)

# Show or save the figure
plt.show()  # or plt.savefig('my_chart.png')
```

## Adding Timing to Your Code

To add timing to your own code:

```python
from utils.timing_logger import TimingContext

# Basic usage
with TimingContext("my_operation", layout_id="abc123") as tc:
    # Code to time goes here
    result = do_something_expensive()
    
    # Add additional info during execution
    tc.add_info({"result_quality": result.score})
```
